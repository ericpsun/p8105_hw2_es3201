---
title: "Homework 2"
author: Eric Sun
output: github_document
---

```{r}
library(tidyverse)
library(readxl)
library(janitor)
```


# Problem 1

Read the Mr. Trashweel dataset
```{r}
trashwheel_df=
  read_xlsx("./data/Trash-Wheel-Collection-Totals-8-6-19.xlsx",
            sheet="Mr. Trash Wheel",
            range= cell_cols("A:N")) %>%
  janitor::clean_names() %>%
  drop_na(dumpster) %>%
mutate(
  sports_balls = round(sports_balls),
  sports_balls = as.integer(sports_balls)
)  %>% view
```

Read precipitation data

```{r}
precip_2018=
  read_excel("./data/Trash-Wheel-Collection-Totals-8-6-19.xlsx",
                       sheet = "2018 Precipitation",
                       skip = 1
             ) %>% 
  janitor::clean_names() %>%
  drop_na(month) %>%
  mutate(year=2018) %>%
  relocate(year)

precip_2017=
  read_excel("./data/Trash-Wheel-Collection-Totals-8-6-19.xlsx",
                       sheet = "2017 Precipitation",
                       skip = 1
             ) %>% 
  janitor::clean_names() %>%
  drop_na(month) %>%
  mutate(year=2017) %>%
  relocate(year)
  
```

Now combine annual precipitation

```{r}
month_df=
  tibble(
    month = 1:12,
    month_name = month.name
  )

precip_df=
  bind_rows(precip_2018, precip_2017)

left_join(precip_df, month_df, by="month")
```

This dataset contains information from the Mr. Trashwheel trash collector in Baltimore, MD. As trash enters the inner harbor, the trashwheel collects that trash, and stores it in a dumpster. The dataset contains information on year, month, and trash collected, include some specific kinds of trash. There are a total of `r nrows(trashweel_df)` rows in our final dataset. Additional data sheets include month precipitation data.

# Problem 2

Read and clean the NYC Transit dataset; retain line, station, name, station latitude / longitude, routes served, entry, vending, entrance type, and ADA compliance. Convert the entry variable from character (YES vs NO) to a logical variable.

```{r import_data}
transit_df= read_csv("./data/NYC_Transit_Subway_Entrance_And_Exit_Data.csv") %>% 
  clean_names() %>%
  select(-division, -exit_only, -staffing, -staff_hours, -ada_notes, -free_crossover, -north_south_street, -east_west_street, -corner, -entrance_latitude, -entrance_longitude, -station_location, -entrance_location) %>%
  mutate(entry=recode(entry, "YES" = "TRUE", "NO" = "FALSE")) %>%
  mutate(entry=as.logical(entry))

str(transit_df)
```

This dataset is 1868x19 and contains 19 variables describing subway lines, station names and locations, routes, entrance types, and ADA-compliance. The data cleaning steps so far have cleaned the column names, removed extraneous columns, and converted a character to a logical variable. These data are mostly tidy, as evidenced by the line and station_name variables which have collapsed multiple possible names into single columns. However, the route1:route11 columns are not tidy.

Find number of distinct stations, number of ADA-compliant stations, and proportion of station entrance/exit without vending allow entrance
```{r}
transit_unique_df= transit_df %>% 
  unite(line_station_name, line, station_name, sep=" ", remove=FALSE) %>%
  relocate(line_station_name) %>%
  distinct(line_station_name, .keep_all=TRUE)

  nrow(transit_unique_df)

transit_unique_df %>% count(ada==TRUE) %>% view()

transit_unique_df %>% count(entry==TRUE & vending=="NO") %>% view()
```
There are 465 unique stations. There are 84 ADA-compliant stations. There are 5/460 station entrance/exit without vending that allow entrance.


